(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{6429:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return i(4759)}])},4126:function(e,t,i){"use strict";i.d(t,{O:function(){return a}});var s=i(8967);let a=(0,s.eI)("https://fkavtsofmglifzalclyn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZrYXZ0c29mbWdsaWZ6YWxjbHluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI5MDgzNDIsImV4cCI6MjA1ODQ4NDM0Mn0.vN8-2RzyVu_2X4lWT4Uqa6aI3OYuAcIFFuMeGS5Po1Y")},4759:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return l}});var s=i(5893),a=i(7294),n=i(1163),r=i(4126);function l(){let e=(0,n.useRouter)(),[t,i]=(0,a.useState)(""),[l,u]=(0,a.useState)(""),[o,c]=(0,a.useState)(""),[d,m]=(0,a.useState)("login");(0,a.useEffect)(()=>{let t=async()=>{let{data:{session:t}}=await r.O.auth.getSession();if(t){let{data:i}=await r.O.from("utilisateurs").select("is_validated").eq("id",t.user.id).single();(null==i?void 0:i.is_validated)?e.push("/espace"):e.push("/pending")}};t()},[]);let p=async i=>{if(i.preventDefault(),c(""),"login"===d){let{data:i,error:s}=await r.O.auth.signInWithPassword({email:t,password:l});if(s)return c("Erreur : "+s.message);let a=i.user,{data:n}=await r.O.from("utilisateurs").select("id").eq("id",a.id).single();n||await r.O.from("utilisateurs").insert([{id:a.id,email:a.email,is_validated:!1,is_admin:!1}]);let{data:u}=await r.O.from("utilisateurs").select("is_validated").eq("id",a.id).single();(null==u?void 0:u.is_validated)?e.push("/dashboard"):e.push("/pending")}else if("signup"===d){let{error:e}=await r.O.auth.signUp({email:t,password:l});if(e)return c("Erreur : "+e.message);alert("Compte cr\xe9\xe9 ! Tu peux maintenant te connecter."),m("login")}else if("reset"===d){let{error:e}=await r.O.auth.resetPasswordForEmail(t);if(e)return c("Erreur : "+e.message);alert("Un email de r\xe9initialisation a \xe9t\xe9 envoy\xe9."),m("login")}};return(0,s.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-100 px-4",children:(0,s.jsxs)("form",{onSubmit:p,className:"bg-white p-6 rounded shadow-md w-full max-w-sm",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4 text-center",children:["login"===d&&"\uD83D\uDD10 Connexion","signup"===d&&"\uD83C\uDD95 Cr\xe9er un compte","reset"===d&&"\uD83D\uDD01 R\xe9initialiser le mot de passe"]}),(0,s.jsx)("input",{className:"w-full border p-2 mb-2 rounded",type:"email",placeholder:"Email",value:t,onChange:e=>i(e.target.value),required:!0}),"reset"!==d&&(0,s.jsx)("input",{className:"w-full border p-2 mb-2 rounded",type:"password",placeholder:"Mot de passe",value:l,onChange:e=>u(e.target.value),required:!0}),o&&(0,s.jsx)("p",{className:"text-red-600 text-sm mb-2",children:o}),(0,s.jsxs)("button",{type:"submit",className:"bg-blue-600 text-white w-full py-2 rounded hover:bg-blue-700",children:["login"===d&&"Se connecter","signup"===d&&"Cr\xe9er le compte","reset"===d&&"Envoyer le lien"]}),(0,s.jsxs)("div",{className:"text-sm text-center mt-4 space-y-1",children:["login"!==d&&(0,s.jsx)("p",{className:"text-blue-600 cursor-pointer",onClick:()=>m("login"),children:"\uD83D\uDD19 Retour \xe0 la connexion"}),"login"===d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-blue-600 cursor-pointer",onClick:()=>m("signup"),children:"\uD83C\uDD95 Cr\xe9er un compte"}),(0,s.jsx)("p",{className:"text-blue-600 cursor-pointer",onClick:()=>m("reset"),children:"\uD83D\uDD01 Mot de passe oubli\xe9 ?"})]})]})]})})}},1163:function(e,t,i){e.exports=i(6885)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=6429)}),_N_E=e.O()}]);