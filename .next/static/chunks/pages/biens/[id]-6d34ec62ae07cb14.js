(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[54],{5984:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/biens/[id]",function(){return s(5705)}])},4126:function(e,n,s){"use strict";s.d(n,{O:function(){return t}});var i=s(8967);let t=(0,i.eI)("https://fkavtsofmglifzalclyn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZrYXZ0c29mbWdsaWZ6YWxjbHluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI5MDgzNDIsImV4cCI6MjA1ODQ4NDM0Mn0.vN8-2RzyVu_2X4lWT4Uqa6aI3OYuAcIFFuMeGS5Po1Y")},5705:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return u}});var i=s(5893),t=s(7294),l=s(1163),r=s(4126),o=s(7054);function a(e){let{lat:n,lng:s}=e,l=(0,t.useMemo)(()=>({lat:n,lng:s}),[n,s]),{isLoaded:r}=(0,o.Ji)({googleMapsApiKey:"AIzaSyBdUW6LH-WYQDi_SmBW8iSm_nO_Uj8oCuU"});return r?(0,i.jsx)("div",{className:"w-full h-64 mt-4 rounded-lg overflow-hidden shadow",children:(0,i.jsx)(o.b6,{center:l,zoom:13,mapContainerStyle:{width:"100%",height:"100%"},children:(0,i.jsx)(o.Jx,{position:l})})}):(0,i.jsx)("p",{children:"Chargement de la carte..."})}function u(){var e,n;let s=(0,l.useRouter)(),{id:o}=s.query,[u,c]=(0,t.useState)(null),[d,D]=(0,t.useState)(null);(0,t.useEffect)(()=>{if(!o)return;let e=async()=>{var e,n;console.log("\uD83D\uDD0D ID du bien re\xe7u :",o);let{data:s}=await r.O.auth.getSession(),i=null==s?void 0:null===(n=s.session)||void 0===n?void 0:null===(e=n.user)||void 0===e?void 0:e.id;D(i);let{data:t,error:l}=await r.O.from("biens").select("*").eq("id",o).single();if(l){console.error("❌ Erreur Supabase :",l);return}if(t&&(!t.lat||!t.lng)){console.log("\uD83D\uDCCD Lancement g\xe9ocodage...");let e=await h(t.ville);e&&(await r.O.from("biens").update({lat:e.lat,lng:e.lng}).eq("id",t.id),t.lat=e.lat,t.lng=e.lng)}console.log("✅ Bien charg\xe9 :",t),c(t)};e()},[o]);let h=async e=>{try{let n=await fetch("https://maps.googleapis.com/maps/api/geocode/json?address=".concat(encodeURIComponent(e),"&key=").concat("AIzaSyBdUW6LH-WYQDi_SmBW8iSm_nO_Uj8oCuU")),s=await n.json();if(s.results.length>0){let{lat:e,lng:n}=s.results[0].geometry.location;return console.log("\uD83D\uDCCD Coordonn\xe9es g\xe9o :",e,n),{lat:e,lng:n}}console.warn("⚠️ Aucun r\xe9sultat g\xe9o pour :",e)}catch(e){console.error("❌ Erreur g\xe9ocodage :",e)}return null};if(!u)return(0,i.jsx)("p",{className:"p-8",children:"⏳ Chargement du bien..."});let x=d===u.agent_id;return(0,i.jsxs)("div",{className:"p-8",children:[(0,i.jsx)("a",{href:"/dashboard",className:"text-sm text-orange-600 hover:underline",children:"⬅️ Retour au Dashboard"}),(0,i.jsx)("h1",{className:"text-3xl font-bold mt-4 mb-4",children:u.titre}),(0,i.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uD83D\uDCCD Ville :"})," ",u.ville]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uD83D\uDCCF Surface :"})," ",u.surface_m2," m\xb2"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uD83D\uDCB0 Prix :"})," ",null===(e=u.prix)||void 0===e?void 0:e.toLocaleString()," €"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uD83D\uDD0B DPE :"})," ",u.dpe]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uD83D\uDCBC Honoraires :"})," ",null===(n=u.honoraires)||void 0===n?void 0:n.toLocaleString()," €"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uD83D\uDCC5 Disponibilit\xe9 :"})," ",u.disponible?"\uD83D\uDFE2 Disponible":"\uD83D\uDD34 Indisponible"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uD83D\uDCE6 Statut :"})," ",u.vendu?"✅ Vendu":u.sous_compromis?"\uD83D\uDCD1 Sous compromis":"\uD83D\uDFE2 En vente"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"\uD83D\uDCDD Description :"}),(0,i.jsx)("div",{className:"bg-white p-4 rounded shadow text-sm text-gray-700 whitespace-pre-wrap",children:u.description})]})]}),u.lat&&u.lng&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{className:"text-lg font-semibold mt-8 mb-2",children:"\uD83D\uDDFA️ Localisation"}),(0,i.jsx)(a,{lat:u.lat,lng:u.lng})]}),x&&(0,i.jsx)("div",{className:"mt-6",children:(0,i.jsx)("a",{href:"/biens/modifier?id=".concat(u.id),className:"inline-block px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 transition",children:"✏️ Modifier ce bien"})})]})}},1163:function(e,n,s){e.exports=s(6885)}},function(e){e.O(0,[255,774,888,179],function(){return e(e.s=5984)}),_N_E=e.O()}]);