(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[324],{8033:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/biens/[id]/modifier",function(){return s(6015)}])},4126:function(e,n,s){"use strict";s.d(n,{O:function(){return l}});var o=s(8967);let l=(0,o.eI)("https://fkavtsofmglifzalclyn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZrYXZ0c29mbWdsaWZ6YWxjbHluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI5MDgzNDIsImV4cCI6MjA1ODQ4NDM0Mn0.vN8-2RzyVu_2X4lWT4Uqa6aI3OYuAcIFFuMeGS5Po1Y")},6015:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return t}});var o=s(5893),l=s(1163),i=s(7294),r=s(4126);function t(){let e=(0,l.useRouter)(),{id:n}=e.query,[s,t]=(0,i.useState)({titre:"",ville:"",prix:"",surface_m2:"",dpe:"",description:"",disponible:!0,sous_compromis:!1,vendu:!1,export_leboncoin:!1,export_seloger:!1}),[a,c]=(0,i.useState)("");(0,i.useEffect)(()=>{if(!n)return;let e=async()=>{let{data:e}=await r.O.from("biens").select("*").eq("id",n).single();if(e){t(e);let{data:n}=r.O.storage.from("photos-biens").getPublicUrl("".concat(e.id,"/main.jpg"));c((null==n?void 0:n.publicUrl)||"")}};e()},[n]);let u=e=>{let{name:n,value:o,type:l,checked:i}=e.target;t({...s,[n]:"checkbox"===l?i:o})},d=async e=>{let s="".concat(n,"/main.jpg"),{error:o}=await r.O.storage.from("photos-biens").upload(s,e,{upsert:!0});if(!o){let{data:e}=r.O.storage.from("photos-biens").getPublicUrl(s);c(null==e?void 0:e.publicUrl)}},p=async o=>{o.preventDefault();let{error:l}=await r.O.from("biens").update({...s,prix:Number(s.prix),surface_m2:Number(s.surface_m2)}).eq("id",n);if(l)alert("❌ Erreur mise \xe0 jour"),console.error(l);else{var i,t;let n=null===(t=document.querySelector("#photo-upload"))||void 0===t?void 0:null===(i=t.files)||void 0===i?void 0:i[0];n&&await d(n),alert("✅ Bien modifi\xe9"),e.push("/biens")}};return s.titre?(0,o.jsxs)("div",{className:"p-8 max-w-2xl mx-auto bg-white rounded shadow mt-8 space-y-4",children:[(0,o.jsx)("h1",{className:"text-2xl font-bold",children:"✏️ Modifier un bien"}),(0,o.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,o.jsx)("input",{name:"titre",value:s.titre,onChange:u,placeholder:"Titre",className:"w-full p-2 border rounded"}),(0,o.jsx)("input",{name:"ville",value:s.ville,onChange:u,placeholder:"Ville",className:"w-full p-2 border rounded"}),(0,o.jsx)("input",{type:"number",name:"prix",value:s.prix,onChange:u,placeholder:"Prix (€)",className:"w-full p-2 border rounded"}),(0,o.jsx)("input",{type:"number",name:"surface_m2",value:s.surface_m2,onChange:u,placeholder:"Surface (m\xb2)",className:"w-full p-2 border rounded"}),(0,o.jsx)("input",{name:"dpe",value:s.dpe,onChange:u,placeholder:"DPE",className:"w-full p-2 border rounded"}),(0,o.jsx)("textarea",{name:"description",value:s.description,onChange:u,placeholder:"Description compl\xe8te",rows:"4",className:"w-full p-2 border rounded"}),a&&(0,o.jsx)("img",{src:a,alt:"Photo",className:"w-full rounded shadow"}),(0,o.jsx)("input",{id:"photo-upload",type:"file",accept:"image/*",className:"block mt-2"}),(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",name:"disponible",checked:s.disponible,onChange:u})," Disponible"]}),(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",name:"sous_compromis",checked:s.sous_compromis,onChange:u})," Sous compromis"]}),(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",name:"vendu",checked:s.vendu,onChange:u})," Vendu"]})]}),(0,o.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,o.jsx)("p",{className:"font-semibold mb-2",children:"\uD83C\uDF10 Export :"}),(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",name:"export_leboncoin",checked:s.export_leboncoin,onChange:u})," LeBonCoin"]}),(0,o.jsx)("br",{}),(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",name:"export_seloger",checked:s.export_seloger,onChange:u})," SeLoger"]})]}),(0,o.jsx)("button",{type:"submit",className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"\uD83D\uDCBE Enregistrer"})]})]}):(0,o.jsx)("div",{className:"p-8",children:"Chargement..."})}},1163:function(e,n,s){e.exports=s(6885)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8033)}),_N_E=e.O()}]);