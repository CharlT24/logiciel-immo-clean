(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[70],{1740:function(e,s,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/utilisateurs",function(){return i(8824)}])},9490:function(e,s,i){"use strict";i.d(s,{Z:function(){return r}});var t=i(5893),a=i(1664),n=i.n(a);function r(){return(0,t.jsxs)("nav",{className:"bg-white shadow mb-6 px-4 py-3 flex justify-center space-x-4",children:[(0,t.jsx)(n(),{href:"/espace",className:"text-blue-600 hover:underline",children:"\uD83C\uDFE1 Espace"}),(0,t.jsx)(n(),{href:"/clients",className:"text-blue-600 hover:underline",children:"\uD83D\uDC65 Ajouter client"}),(0,t.jsx)(n(),{href:"/biens",className:"text-blue-600 hover:underline",children:"\uD83C\uDFE0 Ajouter bien"}),(0,t.jsx)(n(),{href:"/admin/utilisateurs",className:"text-blue-600 hover:underline",children:"\uD83D\uDEE0 Utilisateurs"})]})}},4126:function(e,s,i){"use strict";i.d(s,{O:function(){return a}});var t=i(8967);let a=(0,t.eI)("https://fkavtsofmglifzalclyn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZrYXZ0c29mbWdsaWZ6YWxjbHluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI5MDgzNDIsImV4cCI6MjA1ODQ4NDM0Mn0.vN8-2RzyVu_2X4lWT4Uqa6aI3OYuAcIFFuMeGS5Po1Y")},8824:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return c}});var t=i(5893),a=i(7294),n=i(1163),r=i(4126),l=i(9490);function c(){let[e,s]=(0,a.useState)([]),[i,c]=(0,a.useState)(!0),u=(0,n.useRouter)();(0,a.useEffect)(()=>{d()},[]);let d=async()=>{console.log("✅ Lancement de la v\xe9rification admin");let{data:{session:e},error:s}=await r.O.auth.getSession();if(s||!e)return console.log("❌ Pas de session"),u.push("/login");console.log("Session:",e);let{data:i,error:t}=await r.O.from("utilisateurs").select("is_admin").eq("id",e.user.id).single();if(console.log("R\xe9sultat utilisateur:",i),console.log("Erreur utilisateur:",t),!i||!i.is_admin)return console.log("❌ Pas admin"),u.push("/dashboard");o()},o=async()=>{let{data:e,error:i}=await r.O.from("utilisateurs").select("*").order("created_at",{ascending:!1});i||s(e),c(!1)},m=async e=>{await r.O.from("utilisateurs").update({is_validated:!0}).eq("id",e),o()},h=async(e,s)=>{await r.O.from("utilisateurs").update({is_admin:!s}).eq("id",e),o()};return(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)(l.Z,{}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"\uD83D\uDC64 Gestion des utilisateurs"}),i?(0,t.jsx)("p",{children:"Chargement..."}):(0,t.jsxs)("table",{className:"w-full border-collapse",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-200",children:[(0,t.jsx)("th",{className:"p-2 border",children:"Email"}),(0,t.jsx)("th",{className:"p-2 border",children:"Valid\xe9"}),(0,t.jsx)("th",{className:"p-2 border",children:"Admin"}),(0,t.jsx)("th",{className:"p-2 border",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{className:"text-center border-t",children:[(0,t.jsx)("td",{className:"p-2 border",children:e.email}),(0,t.jsx)("td",{className:"p-2 border",children:e.is_validated?"✅ Oui":"❌ Non"}),(0,t.jsx)("td",{className:"p-2 border",children:e.is_admin?"\uD83D\uDC51 Oui":"—"}),(0,t.jsxs)("td",{className:"p-2 border space-x-2",children:[!e.is_validated&&(0,t.jsx)("button",{className:"text-sm bg-green-500 text-white px-2 py-1 rounded",onClick:()=>m(e.id),children:"Valider"}),(0,t.jsx)("button",{className:"text-sm bg-blue-500 text-white px-2 py-1 rounded",onClick:()=>h(e.id,e.is_admin),children:e.is_admin?"Retirer Admin":"Nommer Admin"})]})]},e.id))})]})]})}},1163:function(e,s,i){e.exports=i(6885)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1740)}),_N_E=e.O()}]);